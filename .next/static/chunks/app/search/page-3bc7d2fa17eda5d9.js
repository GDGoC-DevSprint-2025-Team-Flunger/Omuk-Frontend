(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[959],{9327:(e,t,a)=>{Promise.resolve().then(a.bind(a,6334))},6334:(e,t,a)=>{"use strict";a.d(t,{default:()=>b});var s=a(5155),l=a(2115),r=a(2651),n=a(6046);let c={아침:"BREAKFAST",점심:"LUNCH",저녁:"DINNER",야식:"LATE_NIGHT"},i={매운맛:"SPICY",짠맛:"SALTY",단맛:"SWEET",고소한맛:"SAVORY",신맛:"SOUR",감칠맛:"UMAMI"},m={우유:"MILK",달걀:"EGG",갑각류:"SHELLFISH",밀가루:"WHEAT"},o={봄:"SPRING",여름:"SUMMER",가을:"FALL",겨울:"WINTER"},d=Object.fromEntries(Object.entries(c).map(e=>{let[t,a]=e;return[a,t]})),h=Object.fromEntries(Object.entries(i).map(e=>{let[t,a]=e;return[a,t]})),g=Object.fromEntries(Object.entries(m).map(e=>{let[t,a]=e;return[a,t]})),p={시간대:["아침","점심","저녁","야식"],맛:["매운맛","짠맛","고소한맛","단맛","신맛","감칠맛"],알러지:["우유","달걀","갑각류","밀가루"],계절:["봄","여름","가을","겨울"]};function b(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)(),a=t.get("q")||"",b=parseInt(t.get("page")||"1",10),[u,j]=(0,l.useState)([]),[y,f]=(0,l.useState)({mealTimes:[],tasteTags:[],allergyTags:[],seasons:[]}),[x,N]=(0,l.useState)(!0),T={시간대:"mealTimes",맛:"tasteTags",알러지:"allergyTags",계절:"seasons"},S=(b-1)*16,E=async e=>{try{let t={taste:[Array.from(new Set(e.tasteTags.map(e=>i[e]).filter(Boolean))).join(",")],allergy:[Array.from(new Set(e.allergyTags.map(e=>m[e]).filter(Boolean))).join(",")],time:[Array.from(new Set(e.mealTimes.map(e=>c[e]).filter(Boolean))).join(",")]};await r.A.patch("http://3.38.114.206:8080/member/preference/".concat(1),t),console.log("필터 저장 성공:",t)}catch(e){console.error("필터 저장 실패",e)}},A=async()=>{try{let e=(await r.A.get("http://3.38.114.206:8080/member/preference/".concat(1))).data;f({mealTimes:e.time?[d[e.time]]:[],tasteTags:e.taste?e.taste.split(",").map(e=>h[e]):[],allergyTags:e.allergy?e.allergy.split(",").map(e=>g[e]):[],seasons:[]})}catch(e){console.error("사용자 필터 불러오기 실패",e)}},k=(e,t)=>{let a=y[e].includes(t)?y[e].filter(e=>e!==t):[...y[e],t];f({...y,[e]:a})},v=async()=>{try{let e={};a.trim()&&(e.keyword=a);let t=y.mealTimes.map(e=>c[e]).filter(Boolean);t.length>0&&(e.mealTimes=t);let s=y.tasteTags.map(e=>i[e]).filter(Boolean);s.length>0&&(e.tasteTags=s);let l=y.allergyTags.map(e=>m[e]).filter(Boolean);l.length>0&&(e.excludeAllergies=l);let n=y.seasons.map(e=>o[e]).filter(Boolean);n.length>0&&(e.seasons=n);let d=(Object.keys(e).length>0?await r.A.get("http://3.38.114.206:8080/recipe/recommendation",{params:e,paramsSerializer:e=>{let t=new URLSearchParams;return Object.entries(e).forEach(e=>{let[a,s]=e;Array.isArray(s)?s.forEach(e=>t.append(a,e)):t.append(a,s)}),t.toString()}}):await r.A.get("http://3.38.114.206:8080/recipe/list")).data.map(e=>({id:e.id,title:e.title,imageUrl:e.imageUrl,ingredients:e.ingredients||[]}));j(d)}catch(e){console.error("레시피 불러오기 실패",e)}};(0,l.useEffect)(()=>{A()},[1]),(0,l.useEffect)(()=>{v()},[y,a]);let w=u.slice(S,S+16),O=Math.ceil(u.length/16),C=t=>{let s=new URLSearchParams;s.set("q",a),s.set("page",t.toString()),e.push("/search?".concat(s.toString()))};return(0,s.jsxs)("div",{className:"container py-4",children:[(0,s.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,s.jsx)("h5",{children:"레시피 검색"}),(0,s.jsxs)("div",{className:"d-flex gap-2",children:[(0,s.jsx)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>N(!x),children:x?"필터 접기":"필터 펼치기"}),(0,s.jsx)("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>E(y),children:"필터 저장"}),(0,s.jsx)("button",{className:"btn btn-sm btn-outline-success",onClick:A,children:"필터 불러오기"}),(0,s.jsx)("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>f({mealTimes:[],tasteTags:[],allergyTags:[],seasons:[]}),children:"필터 초기화"})]})]}),x&&(0,s.jsx)("div",{className:"row mb-4",children:Object.entries(p).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"col-md-3 mb-3",children:[(0,s.jsx)("strong",{children:t}),a.map(e=>(0,s.jsxs)("div",{className:"form-check",children:[(0,s.jsx)("input",{className:"form-check-input",type:"checkbox",checked:y[T[t]].includes(e),onChange:()=>k(T[t],e),id:"".concat(t,"-").concat(e)}),(0,s.jsx)("label",{className:"form-check-label",htmlFor:"".concat(t,"-").concat(e),children:e})]},e))]},t)})}),(0,s.jsx)("div",{className:"row gy-4",children:w.length>0?w.map(t=>(0,s.jsx)("div",{className:"col-md-3 col-sm-6",children:(0,s.jsxs)("div",{className:"card position-relative text-white",onClick:()=>e.push("/recipe/".concat(t.id)),style:{cursor:"pointer"},children:[(0,s.jsx)("img",{src:t.imageUrl,className:"card-img",alt:t.title,style:{height:"200px",objectFit:"cover"}}),(0,s.jsx)("div",{className:"card-img-overlay d-flex align-items-end p-2 bg-dark bg-opacity-25",children:(0,s.jsx)("h6",{className:"card-title mb-0",children:t.title})})]})},t.id)):(0,s.jsx)("p",{className:"text-muted",children:"검색 결과가 없습니다."})}),O>1&&(0,s.jsx)("div",{className:"d-flex justify-content-center mt-4",children:[...Array(O)].map((e,t)=>(0,s.jsx)("button",{className:"btn btn-sm mx-1 ".concat(b===t+1?"btn-primary":"btn-outline-primary"),onClick:()=>C(t+1),children:t+1},t+1))})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[238,441,517,358],()=>t(9327)),_N_E=e.O()}]);